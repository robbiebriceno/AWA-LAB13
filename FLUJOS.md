# ğŸ”„ Flujo de AutenticaciÃ³n

## Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NEXT AUTH APP                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   /signIn    â”‚    â”‚  /register   â”‚    â”‚  /dashboard  â”‚ â”‚
â”‚  â”‚   (Login)    â”‚â”€â”€â”€â–¶â”‚  (Registro)  â”‚    â”‚  (Protegido) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                    â”‚                    â–²        â”‚
â”‚         â”‚                    â”‚                    â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                              â”‚                             â”‚
â”‚                              â–¼                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚   NextAuth.js API                  â”‚             â”‚
â”‚         â”‚   /api/auth/[...nextauth]          â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                      â”‚       â”‚       â”‚                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚         â”‚            â”‚       â”‚       â”‚            â”‚        â”‚
â”‚         â–¼            â–¼       â–¼       â–¼            â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Credentialsâ”‚ â”‚ Google  â”‚ â”‚GitHubâ”‚ â”‚Registerâ”‚ â”‚Session â”‚  â”‚
â”‚  â”‚ Provider  â”‚ â”‚Provider â”‚ â”‚Providerâ”‚  API   â”‚ â”‚Callbackâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                       â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                         â–¼                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚              â”‚    Base de Datos     â”‚                      â”‚
â”‚              â”‚  (src/lib/db.ts)     â”‚                      â”‚
â”‚              â”‚                      â”‚                      â”‚
â”‚              â”‚  - users[]           â”‚                      â”‚
â”‚              â”‚  - loginAttempts{}   â”‚                      â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1ï¸âƒ£ Flujo de Registro

```
Usuario                    Frontend                  Backend                   DB
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€â”€â”€â”€[Ir a /register]â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€â”€â”€[Mostrar formulario]â”€â”€â”€â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€[Llenar formulario]â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€[Submit]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â”€â”€[POST /api/auth/      â”‚                      â”‚
  â”‚                           â”‚   register]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Validar datos]     â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Buscar email]â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[No existe]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Hash password      â”‚
  â”‚                           â”‚                         â”‚   con bcrypt]        â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Crear usuario]â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[Usuario creado]â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â—€â”€[201 Created]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€[Redirect a /signIn]â”€â”€â”€â”€â”€â”‚                         â”‚                      â”‚
  â”‚   con mensaje Ã©xito       â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
```

## 2ï¸âƒ£ Flujo de Login con Credenciales

```
Usuario                    Frontend                  Backend                   DB
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€â”€â”€â”€[Ir a /signIn]â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€â”€â”€[Mostrar formulario]â”€â”€â”€â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€[Email + Password]â”€â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€[Submit]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â”€â”€[signIn('credentials', â”‚                      â”‚
  â”‚                           â”‚   {email, password})]â”€â”€â–¶â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Â¿EstÃ¡ bloqueado?]â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[No bloqueado]â”€â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Buscar usuario]â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[Usuario encontrado]â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[bcrypt.compare     â”‚
  â”‚                           â”‚                         â”‚   password]          â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[âœ… VÃ¡lido]         â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Reset intentos]â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Crear JWT token]   â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â—€â”€[200 OK + Session]â”€â”€â”€â”€â”€â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€[Redirect a /dashboard]â”€â”€â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
```

## 3ï¸âƒ£ Flujo de Login Fallido (Bloqueo)

```
Usuario                    Frontend                  Backend                   DB
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â”€â”€[Email + Password       â”‚                         â”‚                      â”‚
  â”‚    INCORRECTA]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â”€â”€[signIn(...)]â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Â¿Bloqueado?]â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[No]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Buscar usuario]â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[Usuario OK]â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[bcrypt.compare]    â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[âŒ INVÃLIDO]       â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Incrementar       â”‚
  â”‚                           â”‚                         â”‚   intentos]â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[Intentos: 1/5]â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â—€â”€[401 Error:            â”‚                      â”‚
  â”‚                           â”‚   "4 intentos           â”‚                      â”‚
  â”‚                           â”‚    restantes"]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€[Mostrar error]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                                                                            â”‚
  â”‚         ... (despuÃ©s del 5to intento fallido) ...                         â”‚
  â”‚                                                                            â”‚
  â”‚â”€â”€[Intento #5 fallido]â”€â”€â”€â”€â–¶â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â”€â”€[signIn(...)]â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[Incrementar]â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â—€â”€[Intentos: 5]â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚â”€â”€[BLOQUEAR cuenta   â”‚
  â”‚                           â”‚                         â”‚   por 15 min]â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚                           â”‚â—€â”€[401 Error:            â”‚                      â”‚
  â”‚                           â”‚   "Cuenta bloqueada     â”‚                      â”‚
  â”‚                           â”‚    por 15 minutos"]â”€â”€â”€â”€â”€â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
  â”‚â—€â”€[Mostrar bloqueo]â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                      â”‚
  â”‚                           â”‚                         â”‚                      â”‚
```

## 4ï¸âƒ£ Flujo de Login con OAuth (Google/GitHub)

```
Usuario                Frontend           NextAuth          Provider         Backend
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚â”€[Click "GitHub"]â”€â”€â”€â”€â–¶â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚â”€[signIn('github')]â–¶                 â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚â”€[Redirect]â”€â”€â”€â”€â”€â–¶â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[GitHub Login Page]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚â”€[Autorizar app]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚â—€â”€[Code + User   â”‚               â”‚
  â”‚                      â”‚                   â”‚   data]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚â”€â”€[Verify]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚â”€â”€[Create        â”‚               â”‚
  â”‚                      â”‚                   â”‚   session]      â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚â—€â”€â”€[Redirect to    â”‚                 â”‚               â”‚
  â”‚                      â”‚    /dashboard]â”€â”€â”€â”€â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
  â”‚â—€â”€[Dashboard page]â”€â”€â”€â”€â”‚                   â”‚                 â”‚               â”‚
  â”‚                      â”‚                   â”‚                 â”‚               â”‚
```

## ğŸ”’ Sistema de Bloqueo - Detalle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SISTEMA DE TRACKING DE INTENTOS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  loginAttempts: Map<email, LoginAttempt>                â”‚
â”‚                                                         â”‚
â”‚  LoginAttempt {                                         â”‚
â”‚    email: string                                        â”‚
â”‚    attempts: number        // 0-5                       â”‚
â”‚    lastAttempt: Date                                    â”‚
â”‚    lockedUntil?: Date      // Date.now() + 15min        â”‚
â”‚  }                                                      â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Intento 1-4: Incrementar contador              â”‚   â”‚
â”‚  â”‚  Mensaje: "X intentos restantes"                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Intento 5: Bloquear cuenta                     â”‚   â”‚
â”‚  â”‚  lockedUntil = Date.now() + 15 * 60 * 1000     â”‚   â”‚
â”‚  â”‚  Mensaje: "Cuenta bloqueada por 15 minutos"     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Login exitoso: Reset contador                  â”‚   â”‚
â”‚  â”‚  loginAttempts.delete(email)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  DespuÃ©s de 15 min: Auto-reset                  â”‚   â”‚
â”‚  â”‚  if (lockedUntil < Date.now())                  â”‚   â”‚
â”‚  â”‚    loginAttempts.delete(email)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Cifrado de ContraseÃ±as

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 BCRYPT HASH FLOW                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  REGISTRO:                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚                                                         â”‚
â”‚  Password: "myPassword123"                              â”‚
â”‚       â”‚                                                 â”‚
â”‚       â–¼                                                 â”‚
â”‚  bcrypt.hash(password, 10)                              â”‚
â”‚       â”‚                                                 â”‚
â”‚       â–¼                                                 â”‚
â”‚  "$2a$10$N9qo8uLO..."  â—€â”€â”€ Se guarda en DB             â”‚
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚  LOGIN:                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚                                                         â”‚
â”‚  Input: "myPassword123"                                 â”‚
â”‚       â”‚                                                 â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚       â”‚              â”‚                                  â”‚
â”‚       â–¼              â–¼                                  â”‚
â”‚  Hash from DB    bcrypt.compare(input, hash)            â”‚
â”‚  "$2a$10$N9..."      â”‚                                  â”‚
â”‚       â”‚              â”‚                                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚              â”‚                                          â”‚
â”‚              â–¼                                          â”‚
â”‚          true/false                                     â”‚
â”‚                                                         â”‚
â”‚  Salt Rounds: 10                                        â”‚
â”‚  Algoritmo: bcrypt                                      â”‚
â”‚  Tiempo: ~100-200ms por hash                            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Proveedores Configurados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             AUTHENTICATION PROVIDERS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  1. CredentialsProvider                              â”‚
â”‚     â”œâ”€ Email + Password                              â”‚
â”‚     â”œâ”€ ValidaciÃ³n con bcrypt                         â”‚
â”‚     â”œâ”€ Rate limiting (5 intentos)                    â”‚
â”‚     â””â”€ Bloqueo temporal                              â”‚
â”‚                                                      â”‚
â”‚  2. GoogleProvider                                   â”‚
â”‚     â”œâ”€ OAuth 2.0                                     â”‚
â”‚     â”œâ”€ Scope: email, profile                         â”‚
â”‚     â””â”€ Auto-provisioning                             â”‚
â”‚                                                      â”‚
â”‚  3. GitHubProvider                                   â”‚
â”‚     â”œâ”€ OAuth 2.0                                     â”‚
â”‚     â”œâ”€ Scope: user:email                             â”‚
â”‚     â””â”€ Auto-provisioning                             â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… Checklist de Seguridad

```
â˜‘ ContraseÃ±as hasheadas (bcrypt)
â˜‘ Salt rounds configurados (10)
â˜‘ Rate limiting implementado
â˜‘ Bloqueo temporal de cuentas
â˜‘ ValidaciÃ³n de email formato
â˜‘ ValidaciÃ³n de contraseÃ±a longitud
â˜‘ PrevenciÃ³n de usuarios duplicados
â˜‘ Sesiones con JWT
â˜‘ CSRF protection (NextAuth)
â˜‘ Secure cookies
â˜‘ NEXTAUTH_SECRET configurado
â˜‘ Callback URLs validadas
â˜‘ Error messages genÃ©ricos (no revelan info)
```
